<!DOCTYPE html>
<html lang="en">
<head>
    <title>Review Transfer</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="fdl-bootstrap/css/fdl-bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/style.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/custom.css" rel="stylesheet" type="text/css" /> 
    <link href="assets/css/mobile_frame.css" rel="stylesheet" type="text/css" />   
   
</head>
<body>
		<div class="bank_frame">
    <div class="bank_header">
        <div class="header_section">
            <div class="bank_top_menu">
                <ul>
                    <li><a href="javascript:void(0);" class="active" title="Mobile"><img src="assets/images/messsage.jpg" width="28" height="23" border="0" 

/>mobile</a><span> | </span></li>
                    <li><a href="javascript:void(0);" title="Approvals">approvals (1)</a> <span> | </span></li>
                    <li><a href="javascript:void(0);" title="Activity">activity</a> <span> | </span></li>
                    <li><a href="javascript:void(0);" title="Settings">settings</a> <span> | </span></li>
                    <li><a href="javascript:void(0);" title="Log Out">log out</a></li>
                </ul>
            </div>
            <div class="bank_logo">
                <a href="javascript:void(0);" title="MyFinanacial Logo"><img src="assets/images/myfinancial.jpg" width="272" height="58" border="0" alt="My 

Financial, Inc" title="My Financial, Inc"/></a>
            </div>
        </div>            
    </div>
    <div class="clearfix"></div>
    <div class="mobmenu">
        <ul class="menu">
            <li><a href="javascript:void(0);" title="Accounts">Accounts</a></li>
            <li><a href="transfer_funds.html" class="active" title="Transfers">Transfers</a></li>
            <li><a href="javascript:void(0);" title="Wires">Wires</a></li>
            <li><a href="javascript:void(0);" title="Pay Bills">Pay Bills</a></li>
            <li><a href="javascript:void(0);" title="Send with Zelle">Send with Zelle<sup>&reg;</sup></a></li>
            <li><a href="javascript:void(0);" title="Trends">Trends</a></li>
            <li><a href="javascript:void(0);" title="Inovice and Payments">Invoice and Payments</a></li>
        </ul>
    </div>
    <div id="ust">
      <div id="menuac"> <span></span> </div>
    </div>
</div>
    <div class="container">
        <a href="#content" class="sr-only sr-only-focusable" id="top" title="Skip to Content">Skip to Content</a>
        <header class="navbar navbar-default navbar-ext">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-haspopup="true" aria-controls="navbar" aria-label="Navigation" aria-expanded="false">
                    <i class="material-icons" aria-hidden="true">apps</i>
                    Menu
                </button>
                <span class="navbar-brand selected mt15">
                    Transfer Funds
                </span>
            </div>
            
             <div class="header-one bankLogoSection"> 
                <div class="bank-name col-xs-9 col-md-10">MyFinancial Bank</div>
                <div class="signout col-xs-3 col-md-2"><a href="javascript:void(0);" title="Sign Out">Sign Out</a></div> 
            </div>
            
					
            
            <!-- Collect the nav links, forms, and other content for toggling -->
            <nav class="navbar-collapse collapse" id="navbar" aria-expanded="false" role="navigation">
                <ul class="nav navbar-nav">
                    <li><a href="transfer_funds.html" title="Transfer Funds" class="selected">Transfer Funds</a></li>
                    <li><a href="activity.html" title="Activity">Activity</a></li>
                    <li><a href="preferences.html" title="Preferences" >Preferences</a></li>
                    <li><a href="help.html" title="Help" >Help</a></li>
                </ul>	
            </nav>

        </header>
        
            <section class="row terms" id="content" role="main">
        	    <form id="transfer_review" method="get" action="transfer_funds_confirm.html">
                	<input type="hidden"  id="transferFund" name="transferType" />
                 	<input type="hidden"  id="from" name="from" />
                    <input type="hidden"  id="to" name="to" />                                 
                    <input type="hidden"  id="send_on" name="sendOn" />
                    <input type="hidden"  id="end_on" name="endOn" />
                    <input type="hidden"  id="end_on_text" name="endOnText" /> 
                    <input type="hidden"  id="frequency" name="frequency" />  
                    <input type="hidden"  id="duration" name="duration" /> 
                    <input type="hidden"  id="total_amt" name="amount" />
                    <input type="hidden"  id="no_transfer" name="noOfTransfers" />
                    <input type="hidden"  id="specifiedAmount" name="totalAmount" />                  
                    <input type="hidden"  id="delivery" name="deliverySpeed" />                   
                    <input type="hidden"  id="email_id" name="recipientEmail" />
                    <input type="hidden"  id="personal_msg" name="personalMsg" />
                    <input type="hidden"  id="memo_msg" name="memo" />
                    <input type="hidden"  id="feesAmount" name="fees" />
                    <input type="hidden"  id="totalTransferAmount" name="finalAmount" />                     
                  </form>
                    
                    <div class="col-xs-12 col-md-9">
                        <h1>Review Transfer</h1>
                        <dl class="review-list">
                            <dt>From </dt>
                            <dd id="fromAccount" name="from"></dd>
                            <dt>To </dt>
                            <dd id="toAccount"></dd>
                            <dt id="sendDate">Send </dt>
                            <dd id="startDate"></dd>
                            <dt id="deliverDate">Deliver </dt>
                            <dd id="endDate">
                            	<span id="endingDate"></span>                                                  
                            </dd>
                            <dt>Speed </dt>
                            <dd><span id="deliverySpeedText"></span></dd> 
                            <dt id="repeat">Repeat Every </dt>
                            <dd id="repeatText"></dd>
                            <dt id="duratn">Duration  </dt>
                            <dd id="durationText"></dd>
                            <dt id="upto">Up to </dt>
               			    <dd id="uptoText"></dd>
                            <dt id="memoName">Memo  </dt>
                            <dd id="memoMsg"></dd> 
                            <dt id="notify">Notify </dt>
                            <dd id="NotifymailId"></dd>
                            <dt id="pMsg">Message </dt>
                            <dd id="personalMessage"></dd>
                        </dl>
                         <dl class="review-list">   
                         	<dt>Transfer Amount </dt>
                            <dd id="transferAmount"></dd>
                            <dt>Fees </dt>
                            <dd id="fees"></dd>
                            <dt>Total </dt>
                            <dd id="finalAmount"></dd>
                        </dl>                                                 
                    </div>                         
            <div class="clearfix"></div>
            <div class="row form-group mt25">
                <div class="col-xs-12 col-md-7">
                	<p class="mt10" id="nextDayText" style="display:none;">We'll immediately withdraw <strong><span id="nextDayTextAmt"></span></strong> when you Confirm.</p>                  
                </div>
            </div>
            <div class="custom-btn">
                <button type="button" class="btn btn-link" id="cancel" title="Cancel">Cancel</button>
                <button type="button" class="btn btn-secondary mr10" id="edit" title="Edit">Edit</button>
                <button type="submit" class="btn btn-primary" id="confirm" title="Confirm">Confirm</button>
            </div>
         </section>
         
          <footer class="footer footerSection">
            <div id="footerHeader" class="container footer-wrapper">
                <div class="text-center pb10">
                    <span><a href="javascript:void(0);" title="Terms of Services">Terms of Services</a></span>
                    <span>| <a href="javascript:void(0);" title="Privacy Policy">Privacy Policy</a></span>
<span>| <a href="javascript:void(0);" title="Security Policy">Security Policy</a></span>
                </div>
                <div class="text-center"><small>Copyright © <span id="currYear"></span> Fiserv Inc. All rights reserved</small></div>
            </div>    
        </footer>
        
    </div>
    <!--FDL JS-->
    <!-- Loader Starts -->

    <div id="pageLoader" style="display:none;">
        <div id="loader-fade"></div>
        <div id="loading-spinner">
            <div class="spinner-icon" aria-label="loading..."></div>
        </div>
    </div>
    
    <!-- Loader Ends -->
    
    
    <script src="fdl-bootstrap/js/jquery.min.js" type="text/javascript"></script>
    <script src="fdl-bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="assets/js/moment.min.js" type="text/javascript"></script>    
	<script>

	/*********************************************************
	*	 Getting URL parameters & values using jquery		 *
	*********************************************************/
			
	$.extend({
		getUrlVars: function(){
			var vars = [], hash;
			var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
			for(var i = 0; i < hashes.length; i++){
				hash = hashes[i].split('=');
				vars.push(hash[0]);
				vars[hash[0]] = hash[1];
			}
			return vars;
		},
		getUrlVar: function(name){
			return $.getUrlVars()[name];
		}
	});
	var allVars = $.getUrlVars();
	
	/* Adding Commas to the Total amount */
	
	$.fn.digits = function(){ 
		return this.each(function(){ 
			$(this).text( $(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,") ); 
		});
	}
</script>
	<script>
    $(document).ready(function(){	
				
		/*************************************************************************************************
		* 	  Getting URL parameters & values using jquery and storing it in the hidden input fields,    * 
		* 		 On Submitting the form, values will be passed to the next page using GET Method.	     *	
		*									 															 *
		* Reference : http://jquery-howto.blogspot.in/2009/09/get-url-parameters-values-with-jquery.html *
		*************************************************************************************************/

		var transfer = encodeURI($.getUrlVar('transferType')).replace(/\+/g, " ");			
		
		var freq = encodeURI($.getUrlVar('frequency')).replace(/\+/g, " ");					
				
		var delvry = encodeURI($.getUrlVar('deliverySpeed')).replace(/\+/g, " ").replace('%2540', '@').replace('%2528','(').replace('%2529',')').replace(/\+/g,' ').replace(/\%20/g," ");							
		
		var duration = encodeURI($.getUrlVar('duration')).replace(/\+/g, " ");	
		//alert(duration);
		
		var from = encodeURI($.getUrlVar('from')).replace('%2528','(').replace('%2529',')').replace(/\+/g,' ').replace(/\%20/g," ").replace(/\ %2524/g," $").replace(/\%252C/g,",");		
		//alert(from);			
		//from = from.split("$")[0];             
		$('#fromAccount').html(from.split(", $")[0]);
		
		var to = encodeURI($.getUrlVar('to')).replace('%2540', '@').replace('%2528','(').replace('%2529',')').replace(/\+/g,' ').replace(/\%20/g," ").replace(/\%2524/g,"$").replace(/\%252C/g,",");	
		$('#toAccount').html(to.split(", $")[0]);		
				
	
		//var to_ktp = encodeURI($.getUrlVar('toKTP')).replace('%2540', '@').replace('%2528','(').replace('%2529',')').replace(/\+/g,' ').replace(/\%20/g," ").replace(/\%252C/g,",");							  
		
		var amount = encodeURI($.getUrlVar('amount')).replace(/\+/g, " ").replace(/\%252C/g,",");
		//amount = parseFloat(amount);
		$('#transferAmount').html("$" + parseFloat(amount).toFixed(2)).digits();						
		//alert(amount)
		
		var start = encodeURI($.getUrlVar('sendOn')).replace(/\+/g, " ").replace(/\%252C/g, ",").replace(/\%252F/g ,'/'); 	
		$('#startDate').html(start);
		//alert(start);
			
		var end = encodeURI($.getUrlVar('endOn')).replace(/\+/g, " ").replace(/\%252C/g, ",").replace(/\%252F/g ,'/');				
		//$('#endDate').html(end);
		
		var email = encodeURI($.getUrlVar('recipientEmail')).replace(/\+/g, " ").replace(/\%2540/g, "@");		
		$('#NotifymailId').html(email);
		
		var msg = encodeURI($.getUrlVar('personalMsg')).replace(/\+/g,' ').replace(/\%20/g," ").replace(/\%253F/g,"?").replace(/\%2521/g,"!").replace(/\%250D%250A/g," ").replace(/\%2527/g, "'").replace(/\%2540/g, "@").replace(/\%2523/g, "#").replace(/\%2524/g, "$").replace(/\%2525/g, "%").replace(/\%255E/g, "^").replace(/\%2526/g, "&").replace(/\%2528/g, "(").replace(/\%2529/g, ")").replace(/\%252B/g, "+").replace(/\%253D/g, "=");
		$('#personalMessage').html(msg);
		            
        var memo = encodeURI($.getUrlVar('memo')).replace(/\+/g,' ').replace(/\%20/g," ").replace(/\%253F/g,"?").replace(/\%2521/g,"!").replace(/\%250D%250A/g," ").replace(/\%2527/g, "'").replace(/\%2540/g, "@").replace(/\%2523/g, "#").replace(/\%2524/g, "$").replace(/\%2525/g, "%").replace(/\%255E/g, "^").replace(/\%2526/g, "&").replace(/\%2528/g, "(").replace(/\%2529/g, ")").replace(/\%252B/g, "+").replace(/\%253D/g, "=");		
		$('#memoMsg').html(memo);
	
									
		var total_amt = encodeURI($.getUrlVar('totalAmount')).replace(/\+/g, " ").replace(/\%252C/g, ",");						
		var no_transfer = encodeURI($.getUrlVar('noOfTransfers')).replace(/\+/g, " ").replace(/\%252C/g, ",");						
		var rec_email = encodeURI($.getUrlVar('chooseRecipientEmail')).replace(/\+/g, " ").replace(/\%252C/g, ",");				
		
		
		if(transfer == "metoothers"){
			$("#NotifymailId, #personalMessage, #notify, #pMsg").show();			
		} else{
			$("#NotifymailId, #personalMessage, #notify, #pMsg").hide();
		}
		
		/*  Hiding the memo fiels if it os empty  */
		
			if(memo == ""){
				$('#memoMsg, #memoName').hide();
			} else{
				$('#memoMsg, #memoName').show();					
			}
				
	
		/* Changing the text based on duration   */
		
		if((freq!="One Time Transfer")){
			if(duration == 'Until I cancel'){
				$("#durationText").text("Until I cancel");
				$("#upto, #uptoText").hide();
			} else if(duration == 'Up to a specified amount'){
				$("#durationText").text(duration);
				$("#uptoText").text('$' + parseFloat(total_amt).toFixed(2));
			} else if(duration == 'Until a specified date'){
				$("#durationText").text(duration);
				$("#uptoText").text(end);
			} else {
				$("#durationText").text(duration);
				$("#uptoText").text(+ no_transfer + ' transfers');
			}
			$("#repeat, #repeatText, #duratn, #durationText").show();			
			$("#sendDate").text("Start ");
			//$("#deliverDate").text("Deliver Date:");
		} else{
			$("#repeat, #repeatText, #duratn, #durationText,#upto, #uptoText").hide();
			$("#sendDate, #deliverDate").text();
		}
		
		 if((freq == 'Once every month')){		
			$("#repeatText").html("Once every month");
		} else if((freq == 'Every 15 days')){
			$("#repeatText").html("Every 15 days");
		} else if((freq == "Every week")){
			$("#repeatText").html("Every week");
		} else if((freq == "Every 2 weeks")){
			$("#repeatText").text("Every 2 weeks");
		} else if((freq == "Every year")){
			$("#repeatText").text("Every year");
		} else if((freq == "First Business Day of Every Month")){
			$("#repeatText").text("First Business Day of Every Month");
		} else if((freq == "Last Business Day of Every Month")){
			$("#repeatText").text("Last Business Day of Every Month");
		} else {			
			$("#durationText").text("Until I cancel");
			$("#repeatText").text("Once every month");
		}
		
		$("#repeatText").html(freq);
		
		
		/****************************************************************************
		*	 			Moment.js for calender calculation for weekdays 			*
		*																			*
		*	Reference : http://momentjs.com/docs/#/displaying/format/				*
		*	Reference : http://jsfiddle.net/dain/5xrr79h0/  						*
		****************************************************************************/
		
		moment.fn.addWorkdays = function (days) {
			var increment = days / Math.abs(days);
			var date = this.clone().add(Math.floor(Math.abs(days) / 5) * 7 * increment, 'days');
			var remaining = days % 5;
			while(remaining != 0) {
			  date.add(increment, 'days');
			  if(date.isoWeekday() !== 6 && date.isoWeekday() !== 7)
				remaining -= increment;
			}
			return date;
		};
		
		var starting_date = moment(start);	
		var zeroday = starting_date.addWorkdays(0).format('MM/DD/YYYY');
		var oneday = starting_date.addWorkdays(1).format('MM/DD/YYYY');
		var threedays = starting_date.addWorkdays(3).format('MM/DD/YYYY');
	
		
		/*  Calculating the fees and text changes basec on the  frequency and duration */
		
		$("#nextDayText").hide();	
		
		function delivery(){
			if((freq == "One Time Transfer")){	
				if(delvry == "instant"){				
					var fee = 5;												
					var new_amount = parseFloat(amount.replace(",","")) + parseFloat(fee);														
					$("#finalAmount, #nextDayTextAmt").html("$" + new_amount.toFixed(2)).digits();									
					$("#fees").html("$" + fee.toFixed(2));	
					$('#endingDate').html(zeroday);	
					$('#deliverySpeedText').html("Instant");		
					$("#nextDayText").hide();		
				} else if(delvry == "nextDay") {						
					var fee = 3;														
					$("#fees").html("$" + fee.toFixed(2));							
					var new_amount = parseFloat(amount.replace(",","")) + parseFloat(fee);											
					$("#finalAmount, #nextDayTextAmt").html("$" + new_amount.toFixed(2)).digits();	
					$('#endingDate').html(oneday);	
					$('#deliverySpeedText').html("Next-Day");		
					$("#nextDayText").show();
				} else {
					$("#fees").html("Free");	
					var amount_val = parseFloat(amount.replace(",",""));														
					$("#finalAmount, #nextDayTextAmt").html("$" + amount_val.toFixed(2)).digits();					
					$('#endingDate').html(threedays);	
					$('#deliverySpeedText').html("Standard") ;
					$("#nextDayText").hide();	
				}
				}
			}
		
		delivery();
				
			/* Fee per Transfer */
		
		if((freq!="One Time Transfer")){			
			if(delvry == "instant"){	
				var fee = 5;									
				var amount_val = parseFloat(amount.replace(",","")) + parseFloat(fee);					
				$("#fees").html("$" + (fee));	
				$('#endingDate').html(zeroday);	
				$('#deliverySpeedText').html("Instant");
				$("#finalAmount, #nextDayTextAmt").html("$" + parseFloat(amount_val).toFixed(2));
			} else if(delvry == "nextDay") {			
				var fee = 3;							
				$("#fees").html("$" + (fee).toFixed(2));			
				var amount_val = parseFloat(amount.replace(",","")) + parseFloat(fee);				
				$("#finalAmount, #nextDayTextAmt").html("$" + parseFloat(amount_val).toFixed(2));	
				$('#endingDate').html(oneday);	
				$('#deliverySpeedText').html("Next-Day");	
			} else {
				$("#fees").html("Free");				
				$("#finalAmount, #nextDayTextAmt").html("$" + parseFloat(amount).toFixed(2)).digits();
				$('#endingDate').html(threedays);	
				$('#deliverySpeedText').html("Standard");	
			}		
		}
				
		/*   Passing the values to the next page */	
		
		$('#transferFund').val(transfer);
		$('#total_amt').val($('#transferAmount').text());
		$('#from').val($('#fromAccount').text());
		$('#to').val($('#toAccount').text());		
		$('#send_on').val($('#startDate').text());
		$('#end_on').val($('#endingDate').text());
		$('#end_on_text').val($('#deliverySpeedText').text());
		$('#frequency').val(freq);
		$('#delivery').val(delvry);
		$('#duration').val(duration);
		$('#specifiedAmount').val(total_amt);
		$('#no_transfer').val(no_transfer);
		$('#email_id').val($('#NotifymailId').text());
		$('#personal_msg').val($('#personalMessage').text());
		$('#memo_msg').val($('#memoMsg').text());
		$('#feesAmount').val($('#fees').text());
		$('#totalTransferAmount').val($('#finalAmount').text());		 		
		
		$("#cancel").click(function(){               
            window.location.href = "transfer_funds.html";		
        });  
		 
		$("#edit").click(function(){                          			
			window.history.back();
        });      
				
		 $("#confirm").click(function(){ 
			 if(amount == 3000){				 
				 $("#pageLoader").show();	
				 setTimeout(function() {	
					$("#transfer_review").attr("action","kba.html").submit();			  				
					$("#pageLoader").hide();
				}, 300);												
			} else if(amount == 2000){					
				$("#pageLoader").show();	
				setTimeout(function() {	
					$("#transfer_review").attr("action","otp.html").submit();					  				
					$("#pageLoader").hide();
				}, 300);								
			} else if((amount == 1000) && (to.split(",")[0]=="Jack Milagro")){							
				$("#pageLoader").show();	
				setTimeout(function() {	
					$("#transfer_review").attr("action","otp.html").submit();					  				
					$("#pageLoader").hide();
				}, 300);	
			} else{					 	
				$("#pageLoader").show();	
				setTimeout(function() {			  
					$("#transfer_review").submit();
					$("#pageLoader").hide();
			}, 300);					
			}  			
        });	
		
		$("#currYear").text((new Date).getFullYear() );
		$('#menuac').click(function(e){	
			$('#menuac').toggleClass('acik');
			$('.mobmenu').toggleClass('mobmenu-acik');
		});			

    });	
</script>
</body>
</html>